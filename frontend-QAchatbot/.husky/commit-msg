#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Validate commit message format
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Allow merge commits and revert commits
if echo "$COMMIT_MSG" | grep -qE "^(Merge|Revert)"; then
  exit 0
fi

# Check if commit message starts with valid type
if ! echo "$COMMIT_MSG" | grep -qE "^(feat|fix|docs|style|refactor|perf|test|chore|ci)(\(.+\))?!?:"; then
  echo "‚ùå Invalid commit message format"
  echo "Commit message must follow the format: type(scope): subject"
  echo "Valid types: feat, fix, docs, style, refactor, perf, test, chore, ci"
  exit 1
fi
