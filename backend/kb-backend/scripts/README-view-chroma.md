# Chroma æ•°æ®åº“æŸ¥çœ‹å·¥å…·ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½è¯´æ˜

`view-chroma-db.js` æ˜¯ä¸€ä¸ªç±»ä¼¼ MySQL çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæŸ¥çœ‹ Chroma å‘é‡æ•°æ®åº“çš„å†…å®¹ã€‚

## åŸºæœ¬ç”¨æ³•

### 1. æŸ¥çœ‹æ‰€æœ‰é›†åˆï¼ˆç±»ä¼¼ `SHOW TABLES`ï¼‰

```bash
# æŸ¥çœ‹ server æ¨¡å¼çš„æ‰€æœ‰é›†åˆ
node scripts/view-chroma-db.js server

# æŸ¥çœ‹ persistent æ¨¡å¼çš„æ‰€æœ‰é›†åˆ
node scripts/view-chroma-db.js persistent
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ“Š Chroma æ•°æ®åº“ - SERVER æ¨¡å¼
================================================================================

ğŸ“‹ æ‰¾åˆ° 1 ä¸ªé›†åˆï¼ˆè¡¨ï¼‰:

1. é›†åˆåç§°: kb_documents
   ğŸ“ è®°å½•æ•°: 123
   ğŸ“Œ å…ƒæ•°æ®:
      {
        "description": "Knowledge base documents"
      }
```

### 2. æŸ¥çœ‹æŒ‡å®šé›†åˆçš„è®°å½•ï¼ˆç±»ä¼¼ `SELECT * FROM table`ï¼‰

```bash
# æŸ¥çœ‹ server æ¨¡å¼çš„ kb_documents é›†åˆï¼ˆé»˜è®¤æ˜¾ç¤ºå‰50æ¡ï¼‰
node scripts/view-chroma-db.js server kb_documents

# æŸ¥çœ‹å‰ 10 æ¡è®°å½•
node scripts/view-chroma-db.js server kb_documents 10

# æŸ¥çœ‹ persistent æ¨¡å¼çš„é›†åˆ
node scripts/view-chroma-db.js persistent kb_documents

# æ˜¾ç¤ºå®Œæ•´å‘é‡ä¿¡æ¯
node scripts/view-chroma-db.js server kb_documents 10 --show-vector

# æ˜¾ç¤ºå®Œæ•´å‘é‡å’Œç»Ÿè®¡ä¿¡æ¯
node scripts/view-chroma-db.js server kb_documents 10 --full-vector
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ“– æŸ¥çœ‹é›†åˆ: kb_documents (SERVER æ¨¡å¼)
================================================================================

ğŸ“Š æ€»è®°å½•æ•°: 123
ğŸ“„ æ˜¾ç¤ºå‰ 10 æ¡è®°å½•

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è®°å½• #1
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ID: abc-123-def-456

ğŸ“ æ–‡æœ¬å†…å®¹:
   è¿™æ˜¯æ–‡æ¡£çš„ç¬¬ä¸€æ®µå†…å®¹...

ğŸ“Œ å…ƒæ•°æ®:
   filename: æ–‡æ¡£.pdf
   sourceType: file
   createdAt: 2025/11/30 16:23:33
   uploadedBy: admin

ğŸ”¢ å‘é‡ç»´åº¦: 1024
   å‘é‡é¢„è§ˆ: [0.1234, -0.5678, 0.9012, ...]
```

## å‘½ä»¤å‚æ•°

```
node scripts/view-chroma-db.js [mode] [collection] [limit] [options]
```

- `mode`: å­˜å‚¨æ¨¡å¼ï¼Œå¯é€‰å€¼ï¼š
  - `server` - æœåŠ¡å™¨æ¨¡å¼ï¼ˆç«¯å£ 8000ï¼‰
  - `persistent` - æœ¬åœ°æ–‡ä»¶æ¨¡å¼ï¼ˆç«¯å£ 8001ï¼‰
  - å¦‚æœä¸æŒ‡å®šï¼Œä½¿ç”¨ `.env` æ–‡ä»¶ä¸­çš„ `VECTOR_STORE_MODE` é…ç½®

- `collection`: é›†åˆåç§°ï¼ˆå¯é€‰ï¼‰
  - å¦‚æœä¸æŒ‡å®šï¼Œæ˜¾ç¤ºæ‰€æœ‰é›†åˆåˆ—è¡¨
  - å¦‚æœæŒ‡å®šï¼Œæ˜¾ç¤ºè¯¥é›†åˆçš„è¯¦ç»†è®°å½•

- `limit`: æ˜¾ç¤ºè®°å½•æ•°é™åˆ¶ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 50ï¼‰
  - ä»…åœ¨æŒ‡å®š `collection` æ—¶æœ‰æ•ˆ

- `options`: é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
  - `--show-vector` - æ˜¾ç¤ºå®Œæ•´å‘é‡æ•°æ®
  - `--full-vector` - æ˜¾ç¤ºå®Œæ•´å‘é‡æ•°æ®å’Œç»Ÿè®¡ä¿¡æ¯ï¼ˆåŒ…æ‹¬æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰
  - `--help` æˆ– `-h` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: æ£€æŸ¥æ•°æ®åº“ä¸­æœ‰å“ªäº›é›†åˆ

```bash
node scripts/view-chroma-db.js server
```

### åœºæ™¯ 2: æŸ¥çœ‹æŸä¸ªé›†åˆæœ‰å¤šå°‘æ¡è®°å½•

```bash
node scripts/view-chroma-db.js server kb_documents 1
# åªçœ‹ç¬¬ä¸€æ¡è®°å½•ï¼Œä¸»è¦å…³æ³¨æ€»è®°å½•æ•°
```

### åœºæ™¯ 3: æŸ¥çœ‹æœ€è¿‘ä¸Šä¼ çš„æ–‡æ¡£

```bash
node scripts/view-chroma-db.js server kb_documents 20
# æŸ¥çœ‹æœ€è¿‘ 20 æ¡è®°å½•
```

### åœºæ™¯ 4: æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®å­˜å‚¨

```bash
# å…ˆæŸ¥çœ‹æ‰€æœ‰é›†åˆ
node scripts/view-chroma-db.js server

# ç„¶åæŸ¥çœ‹å…·ä½“é›†åˆçš„å†…å®¹
node scripts/view-chroma-db.js server <é›†åˆåç§°> 5
```

### åœºæ™¯ 5: æŸ¥çœ‹å‘é‡ä¿¡æ¯

```bash
# æŸ¥çœ‹å®Œæ•´å‘é‡æ•°æ®
node scripts/view-chroma-db.js server kb_documents 1 --show-vector

# æŸ¥çœ‹å‘é‡ç»Ÿè®¡ä¿¡æ¯ï¼ˆåŒ…æ‹¬æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ ‡å‡†å·®ç­‰ï¼‰
node scripts/view-chroma-db.js server kb_documents 1 --full-vector
```

**å‘é‡ä¿¡æ¯è¯´æ˜ï¼š**
- **å‘é‡ç»´åº¦**ï¼šå‘é‡çš„é•¿åº¦ï¼ˆé€šå¸¸æ˜¯ 1024ï¼‰
- **å®Œæ•´å‘é‡**ï¼šæ‰€æœ‰ç»´åº¦çš„æ•°å€¼ï¼ˆæ¯è¡Œæ˜¾ç¤º 10 ä¸ªå€¼ï¼‰
- **ç»Ÿè®¡ä¿¡æ¯**ï¼ˆä½¿ç”¨ `--full-vector` æ—¶æ˜¾ç¤ºï¼‰ï¼š
  - æœ€å°å€¼ (min)
  - æœ€å¤§å€¼ (max)
  - å¹³å‡å€¼ (mean)
  - æ ‡å‡†å·® (std)
  - æ€»å’Œ (sum)
  - é›¶å€¼æ•°é‡å’Œéé›¶å€¼æ•°é‡

## ä¸ MySQL å¯¹æ¯”

| MySQL å‘½ä»¤ | Chroma æŸ¥çœ‹å·¥å…· |
|-----------|----------------|
| `SHOW TABLES` | `node scripts/view-chroma-db.js [mode]` |
| `SELECT COUNT(*) FROM table` | å·¥å…·è‡ªåŠ¨æ˜¾ç¤ºè®°å½•æ•° |
| `SELECT * FROM table LIMIT 10` | `node scripts/view-chroma-db.js [mode] table 10` |
| `DESCRIBE table` | å·¥å…·æ˜¾ç¤ºé›†åˆçš„å…ƒæ•°æ®ä¿¡æ¯ |

## æ³¨æ„äº‹é¡¹

1. **ç¡®ä¿æœåŠ¡å™¨è¿è¡Œ**
   - server æ¨¡å¼ï¼š`docker-compose up -d`
   - persistent æ¨¡å¼ï¼š`docker-compose -f docker-compose.persistent.yml up -d`

2. **é»˜è®¤é›†åˆåç§°**
   - é¡¹ç›®é»˜è®¤ä½¿ç”¨ `kb_documents` ä½œä¸ºé›†åˆåç§°
   - å¯ä»¥é€šè¿‡ `.env` æ–‡ä»¶ä¸­çš„ `CHROMA_COLLECTION_NAME` é…ç½®

3. **æ•°æ®é‡è¾ƒå¤§æ—¶**
   - ä½¿ç”¨ `limit` å‚æ•°é™åˆ¶æ˜¾ç¤ºæ•°é‡
   - é¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤šæ•°æ®

4. **å‘é‡æ•°æ®**
   - é»˜è®¤åªæ˜¾ç¤ºå‘é‡çš„ç»´åº¦ï¼ˆé€šå¸¸æ˜¯ 1024ï¼‰å’Œå‰ 5 ä¸ªç»´åº¦çš„é¢„è§ˆ
   - ä½¿ç”¨ `--show-vector` å¯ä»¥æŸ¥çœ‹å®Œæ•´å‘é‡æ•°æ®
   - ä½¿ç”¨ `--full-vector` å¯ä»¥æŸ¥çœ‹å®Œæ•´å‘é‡æ•°æ®å’Œç»Ÿè®¡ä¿¡æ¯

## æ•…éšœæ’é™¤

### é”™è¯¯ï¼šè¿æ¥å¤±è´¥

```
âœ— è¿æ¥å¤±è´¥: Failed to connect to chromadb
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
docker ps

# å¯åŠ¨ server æ¨¡å¼
docker-compose up -d

# å¯åŠ¨ persistent æ¨¡å¼
docker-compose -f docker-compose.persistent.yml up -d
```

### é”™è¯¯ï¼šé›†åˆä¸å­˜åœ¨

```
âœ— æŸ¥çœ‹å¤±è´¥: Collection not found
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# å…ˆæŸ¥çœ‹æ‰€æœ‰é›†åˆ
node scripts/view-chroma-db.js server

# ä½¿ç”¨æ­£ç¡®çš„é›†åˆåç§°
```

## ç›¸å…³æ–‡ä»¶

- `src/vectorStoreChroma.js` - Chroma å‘é‡å­˜å‚¨å®ç°
- `src/config.js` - é…ç½®æ–‡ä»¶
- `docker-compose.yml` - server æ¨¡å¼é…ç½®
- `docker-compose.persistent.yml` - persistent æ¨¡å¼é…ç½®

